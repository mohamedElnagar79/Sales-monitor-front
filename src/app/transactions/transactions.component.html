<div class="container mt-5 px-5">
  <div class="transactions-head">
    <h3>Our Transactions</h3>
    <h3>
      total
      <span class="total-money"
        >{{ totalExistMoney | number : "1.0-0" }} EGP</span
      >
    </h3>
  </div>
  <div class="transactions-head">
    <input
      type="text"
      class="search-input"
      name="search"
      (keyup)="calcDailySales(p, getFormattedDate(), search)"
      [(ngModel)]="search"
    />
    <input
      type="date"
      class="search-input"
      name="date"
      (change)="calcDailySales(p, searchDate, search)"
      [(ngModel)]="searchDate"
    />
  </div>
  <ul class="nav nav-tabs mb-3 mt-4" id="ex1" role="tablist">
    <li class="nav-item" role="presentation">
      <a
        class="nav-link active"
        id="ex1-tab-1"
        data-bs-toggle="tab"
        href="#ex1-tabs-1"
        role="tab"
        aria-controls="ex1-tabs-1"
        aria-selected="true"
        >ŸèEntry</a
      >
    </li>
    <li class="nav-item" role="presentation">
      <a
        class="nav-link"
        id="ex1-tab-2"
        data-bs-toggle="tab"
        href="#ex1-tabs-2"
        role="tab"
        aria-controls="ex1-tabs-2"
        aria-selected="false"
        >Expenses</a
      >
    </li>
  </ul>
  <div class="tab-content" id="ex1-content">
    <div
      class="tab-pane fade show active"
      id="ex1-tabs-1"
      role="tabpanel"
      aria-labelledby="ex1-tab-1"
    >
      <h1 class="empty-data" *ngIf="sales.length == 0">There Is No orders</h1>
      <!-- start of accordion -->
      <div class="accordion accordion-flush" id="accordionFlushExample">
        <div
          *ngFor="let invoice of sales; let i = index"
          class="accordion-item my-3"
        >
          <h2 class="accordion-header">
            <button
              class="accordion-button collapsed"
              type="button"
              data-bs-toggle="collapse"
              [attr.data-bs-target]="'#collapse' + invoice.id"
              aria-expanded="false"
              [attr.aria-controls]="'collapse' + invoice.id"
            >
              {{ invoice.client.name }}
            </button>
          </h2>
          <div
            [id]="'collapse' + invoice.id"
            class="accordion-collapse collapse"
            data-bs-parent="#accordionFlushExample"
          >
            <div class="accordion-body">
              <div class="table-container table-responsive">
                <table
                  class="table orders-table fixed-height table-responsive"
                  *ngIf="sales.length > 0"
                >
                  <thead>
                    <tr>
                      <td>No.</td>
                      <td>Product Name</td>
                      <td>Piece price</td>
                      <td>Qty</td>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      *ngFor="
                        let invoiceItem of invoice.invoice_items
                          | paginate
                            : {
                                itemsPerPage: 8,
                                currentPage: p,
                                totalItems: salesCount
                              };
                        let i = index
                      "
                    >
                      <td>{{ i + startIndex }}</td>
                      <td>{{ invoiceItem.product.name }}</td>
                      <td>
                        {{ invoiceItem.piecePrice | number : "1.0-0" }} EGP
                      </td>
                      <td>{{ invoiceItem.quantity }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- end of accordions -->
      <pagination-controls
        *ngIf="sales.length > 0"
        (pageChange)="p = $event; calcDailySales(p, searchDate)"
      ></pagination-controls>
    </div>
    <!-- expenses tab -->
    <div
      class="tab-pane fade"
      id="ex1-tabs-2"
      role="tabpanel"
      aria-labelledby="ex1-tab-2"
    >
      <h1 *ngIf="dailyExpense.length == 0" class="empty-data">
        There Is No Expenses
      </h1>
      <div
        class="table-container table-responsive"
        *ngIf="dailyExpense.length > 0"
      >
        <table class="table fixed-height table-responsive">
          <thead>
            <tr>
              <th>No.</th>
              <td>Expense Name</td>
              <td>Description</td>
              <td>Amount</td>
            </tr>
          </thead>
          <tbody>
            <tr
              *ngFor="
                let expenseItem of dailyExpense
                  | paginate
                    : {
                        itemsPerPage: 8,
                        currentPage: p,
                        totalItems: expenseCount
                      };
                let i = index
              "
            >
              <td>{{ i + startIndex }}</td>
              <td>{{ expenseItem.expenseName }}</td>
              <td>{{ expenseItem.description }}</td>
              <td>{{ expenseItem.amount | number : "1.0-0" }}</td>
            </tr>
            <tr>
              <td></td>
              <td></td>
              <td></td>
              <td>
                <b>{{ totalDailyExpense | number : "1.0-0" }}</b>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <pagination-controls
        *ngIf="dailyExpense.length > 0"
        (pageChange)="p = $event; calcDailySales(p, searchDate)"
      ></pagination-controls>
    </div>
  </div>
</div>
